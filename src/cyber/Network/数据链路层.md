---
title: 数据链路层
category: 计算机网络
---
# 数据链路层

## 概念和功能

- 基础概念

  - 数据链路层的地位

  - 链路与数据链路

  - PDU-帧

- 两种信道

  - 广播信道（CSMA/CD协议）

  - 点对点信道（PPP协议）

- 三种基本问题

  - 封装成帧

    - 最大传送单元MTU

      - 限制帧中数据部分的最大长度

      - MTU = IP层 + 全部数据

      - 默认值：1500

    - 帧界定

  - 透明传输

    - 组帧方式

      - 字符计数法

        - 缺点：一步错，步步错

        - 每一段数据流的第一位定义帧长度

      - 字符（字节）填充法

        - 在数据中出现的SOH/EOT前填充一个转义字符ESC

      - 零比特填充法

        - 每5个1后填充1个0

      - 违规编码法

  - 差错检测

    - 差错

      - 位错（比特差错）

      - 帧错

        - 帧丢失

        - 帧重复

        - 帧失序

    - 检测

      - 循环冗余检验CRC

        - 1.计算：在k位原始数据后拼接n个0 后 除以 约定好的n+1 位的除数

        - 2.拼接：在原始数据后拼接计算好的冗余码

        - 3.发送后接受端校验余数

      - 冗余码

        - 帧检验序列FCS

    - 纠错

      - 差错控制编码（信道编码）

        - 引入冗余

## 广域网

- 主要位于物理层、数据链路层、网络层

  - PPP

    - 满足的要求

    - 三个协议组件

      - 数据封装方式

      - 链路控制协议LCP

      - 网络控制协议NCP

    - 帧格式

      - 帧长度为整数字节

      - 各字段意义

        - 首部

          - 开始标志字段F

          - 地址字段A

          - 控制字段C

          - 协议字段

        - 尾部

          - 帧校验序列FCS

          - 结束标志字段F

      - 透明传输问题

        - 异步传输

          - 字节填充

        - 同步传输

          - 零比特填充

    - 状态图

    - 两种认证方式

      - 口令鉴别协议RAP

        - 两次握手，明文传输口令

      - 口令握手鉴别协议CHAP

        - 三次握手，不明文传输口令，取代口令的是hash

        - 认证报文耗费带宽

  - HDLC＊

    - 面向比特的同步协议

    - 有国际标准化组织（ISO）制定

    - 是串行线路的默认封装，无认证

  - 帧中继＊

  - MPLS（2.5层协议，第四章）

## 局域网

- 拓补分类

  - 总线型

  - 星型（逻辑总线）

  - 环型

- 媒体共享技术

  - 静态划分信道

    - 频分复用

    - 时分复用

    - 波分复用

    - 码分复用

  - 动态分配信道（多点接入）

    - 随机接入

    - 受控接入

- 以太网

  - 以太网MAC层

    - 硬件地址/物理地址/MAC地址

    - 一适配器一地址

    - 构成

      - 长度6字节（48bit）

      - 前3字节由IEEE的注册管理机构RA向厂家分配，称为组织唯一标识符

      - 后3字节由 厂家自行指派，称为唯一标识符

    - 分类

      - 单播MAC地址

        - 第一字节最低位为0

      - 组播MAC地址

        - 第一字节最低位为1

      - 广播MAC地址

        - 每一位字节都为1

    - 帧格式

      - 目的地址（6字节）

      - 源地址（6字节）

      - 类型（2字节）

      - 数据字段（46～1500）

      - 帧检验序列FCS（4字节）

  - 总线型以太网

    - 载波监听多点接入/碰撞检测CSMA/CD

      - 多点接入

        - 总线型网络

      - 载波监听

        - 不管在发送数据前或发送数据过程中，都不停地检测信道

      - 碰撞检测

        - 边发送边检测信道上信号电压的变化

          - 半双工通信

      - 先听后说，边听边说，冲突停止，延迟重发

    - 设备

      - 集线器（物理层）

  - 交换式以太网

    - 设备（数据链路层

      - 交换机

        - 交换机特点

          - 接口数量多

          - 全双工

          - 并行

          - 传输无冲突

          - 接口存储器

          - 即插即用

          - 转发效率高

        - 自学习

        - 交换方式

          - 存储转发

          - 直通

          - 碎片隔离

      - 网桥

  - 采取的两种措施

    - 采用无连接的工作方式

    - 使用曼彻斯特编码

  - 重传机制

    - 截断二进制指数退避

      - 发送碰撞停止发送数据后，退避一个随机时间

      - 基本退避时间 = 2*发送时延

      - 参数k = min[重传次数,10]

      - 从整数集合[0,...,2^k - 1]中取任何一个数，记为r

      - 重传时延 = r * 基础退避时延

      - 重传16次后丢弃该帧

  - 最小帧长问题

    - 帧的传输时延 >= 两倍的传输时延

    - 最小帧长度 = 传播时延 ＊ 发送速率 ＊ 2

  - 10Mbit/s以太网争用期长度

    - 51.2微秒

    - 争用期内可发送512bit，即64字节

    - 若前64字节没有发生冲突，则后续数据就不会发生冲突

    - 因此以太网最小有效帧长为64字节

    - 以太网帧长度范围：64～1518字节

- 虚拟局域网

  - 广播域和冲突域

  - vlan标签

    - 4字节

    - 前两字节为802.1Q标签类型

    - 后两字节为 标签控制信息

      - 前4位实际无用

      - 后12位vlan标识符VID

    - 接入链路不带标签

      - 主机与交换机

    - 干道链路带标签

      - 交换机与交换机

  - vlan划分方法

    - 基于端口

      - 最简单、最常用

      - 在第一层划分虚拟局域网

      - 缺点 不允许用户移动

    - 基于MAC地址＊

      - 在第二层划分局域网

      - 允许用户移动

      - 缺点 需要输入和管理大量的MAC地址

    - 基于协议＊

    - 基于IP子网地址＊

    - 基于高层应用或服务＊

      - 更灵活、更复杂

- 高速以太网＊